<!-- saved from url=(0014)about:internet -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>PathAnimator.as</title>
<link rel="stylesheet" type="text/css" href="../../../../SourceStyles.css"/>
</head>

<body><pre><span class="ActionScriptpackage">package</span> <span class="ActionScriptDefault_Text">away3d</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">animators</span><span class="ActionScriptBracket/Brace">{</span>    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">EventDispatcher</span>;    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">geom</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Vector3D</span>;        <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">away3d</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">extrusions</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">utils</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PathUtils</span>;    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">away3d</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">extrusions</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">utils</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Path</span>;    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">away3d</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">extrusions</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">utils</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PathSegment</span>;    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">away3d</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PathEvent</span>;    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">away3d</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">core</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">base</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Object3D</span>;         <span class="ActionScriptReserved">public</span> <span class="ActionScriptclass">class</span> <span class="ActionScriptDefault_Text">PathAnimator</span> <span class="ActionScriptReserved">extends</span> <span class="ActionScriptDefault_Text">EventDispatcher</span>    <span class="ActionScriptBracket/Brace">{</span>        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_path</span>:<span class="ActionScriptDefault_Text">Path</span>;        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_time</span>:<span class="ActionScriptDefault_Text">Number</span>;        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_index</span>:<span class="ActionScriptDefault_Text">uint</span> <span class="ActionScriptOperator">=</span> 0;        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_rotations</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">Vector3D</span><span class="ActionScriptBracket/Brace">&gt;</span>;        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_lookAt</span>:<span class="ActionScriptDefault_Text">Boolean</span>;        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_alignToPath</span>:<span class="ActionScriptDefault_Text">Boolean</span>;        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_target</span>:<span class="ActionScriptDefault_Text">Object3D</span>;        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_lookAtTarget</span>:<span class="ActionScriptDefault_Text">Object3D</span>;        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_offset</span>:<span class="ActionScriptDefault_Text">Vector3D</span>;        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_tmpOffset</span>:<span class="ActionScriptDefault_Text">Vector3D</span>;        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_position</span>:<span class="ActionScriptDefault_Text">Vector3D</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Vector3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_lastTime</span>:<span class="ActionScriptDefault_Text">Number</span>;        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_from</span>:<span class="ActionScriptDefault_Text">Number</span>;        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_to</span>:<span class="ActionScriptDefault_Text">Number</span>;        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_bRange</span>:<span class="ActionScriptDefault_Text">Boolean</span>;        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_bSegment</span>:<span class="ActionScriptDefault_Text">Boolean</span>;        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_bCycle</span>:<span class="ActionScriptDefault_Text">Boolean</span>;        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_lastSegment</span>:<span class="ActionScriptDefault_Text">uint</span> <span class="ActionScriptOperator">=</span> 0;        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_rot</span>:<span class="ActionScriptDefault_Text">Vector3D</span>;        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_worldAxis</span>:<span class="ActionScriptDefault_Text">Vector3D</span>;        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_basePosition</span>:<span class="ActionScriptDefault_Text">Vector3D</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Vector3D</span><span class="ActionScriptBracket/Brace">(</span>0<span class="ActionScriptOperator">,</span>0<span class="ActionScriptOperator">,</span>0<span class="ActionScriptBracket/Brace">)</span>;                 <span class="ActionScriptASDoc">/**        * Creates a new &lt;PathAnimator&gt;PathAnimator&lt;/code&gt;        *         * @param                 [optional] path                    The path to animate onto.        * @param                 [optional] target                    An Object3D, the object to animate along the path. It can be Mesh, Camera, ObjectContainer3D...        * @param                 [optional] alignToPath            Defines if the object animated along the path is orientated to the path. Default is true.        * @param                 [optional] lookAtTarget        An Object3D that the target will constantly look at during animation.        * @param                 [optional] offset                    A Vector3D to define the target offset to its location on the path.        * @param                 [optional] rotations                A Vector.&lt;Vector3D&gt; to define rotations per pathsegments. If PathExtrude is used to simulate the "road", use the very same rotations vector.        */</span>        <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">PathAnimator</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">path</span>:<span class="ActionScriptDefault_Text">Path</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">target</span>:<span class="ActionScriptDefault_Text">Object3D</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">offset</span>:<span class="ActionScriptDefault_Text">Vector3D</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">alignToPath</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">lookAtTarget</span>:<span class="ActionScriptDefault_Text">Object3D</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">rotations</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">Vector3D</span><span class="ActionScriptBracket/Brace">&gt;</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptDefault_Text">_index</span> <span class="ActionScriptOperator">=</span> 0;            <span class="ActionScriptDefault_Text">_time</span><span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_lastTime</span><span class="ActionScriptOperator">=</span>0;                         <span class="ActionScriptDefault_Text">_path</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">path</span>;            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_path</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">_worldAxis</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_path</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">worldAxis</span>;                        <span class="ActionScriptDefault_Text">_target</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">target</span>;            <span class="ActionScriptDefault_Text">_alignToPath</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">alignToPath</span>;            <span class="ActionScriptDefault_Text">_lookAtTarget</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">lookAtTarget</span>;                        <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">offset</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">setOffset</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">offset</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">offset</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">offset</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">z</span><span class="ActionScriptBracket/Brace">)</span>;                             <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">rotations</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">rotations</span>;                        <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_lookAtTarget</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">_alignToPath</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">_alignToPath</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;                    <span class="ActionScriptBracket/Brace">}</span>                 <span class="ActionScriptASDoc">/**        * sets an optional offset to the position on the path, ideal for cameras or reusing the same &lt;code&gt;Path&lt;/code&gt; object for parallel animations        */</span>        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">setOffset</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">x</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">y</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">z</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 0<span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">_offset</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">_offset</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Vector3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;                        <span class="ActionScriptDefault_Text">_offset</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">x</span>;            <span class="ActionScriptDefault_Text">_offset</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">y</span>;            <span class="ActionScriptDefault_Text">_offset</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">z</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">z</span>;        <span class="ActionScriptBracket/Brace">}</span>                 <span class="ActionScriptASDoc">/**        * Calculates the new position and set the object on the path accordingly        *        * @param t     A Number  from 0 to 1  (less than one to allow alignToPath)        */</span>        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">updateProgress</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">t</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">_path</span><span class="ActionScriptBracket/Brace">)</span>  <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Error</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"No Path object set for this class"</span><span class="ActionScriptBracket/Brace">)</span>;                        <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">t</span><span class="ActionScriptOperator">&lt;=</span> 0<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">{</span>                <span class="ActionScriptDefault_Text">t</span> <span class="ActionScriptOperator">=</span> 0;                <span class="ActionScriptDefault_Text">_lastSegment</span> <span class="ActionScriptOperator">=</span> 0;            <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">t</span><span class="ActionScriptOperator">&gt;=</span>1<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">{</span>                <span class="ActionScriptDefault_Text">t</span> <span class="ActionScriptOperator">=</span> 1;                <span class="ActionScriptDefault_Text">_lastSegment</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_path</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span><span class="ActionScriptOperator">-</span>1;            <span class="ActionScriptBracket/Brace">}</span>                        <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">_bCycle</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">t</span><span class="ActionScriptOperator">&lt;=</span>0.1 <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">_lastSegment</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">_path</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span><span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">)</span>                 <span class="ActionScriptDefault_Text">dispatchEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">PathEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">PathEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">CYCLE</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;                        <span class="ActionScriptDefault_Text">_lastTime</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">t</span>;                        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">multi</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_path</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">t</span>;            <span class="ActionScriptDefault_Text">_index</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">multi</span>;                        <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_index</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">_path</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">index</span> <span class="ActionScriptOperator">--</span>;                         <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_offset</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>                <span class="ActionScriptDefault_Text">_target</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">position</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_basePosition</span>;                        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">nT</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">multi</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">_index</span>;            <span class="ActionScriptDefault_Text">updatePosition</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">nT</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">PathSegment</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_path</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">segments</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">_index</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">)</span>;                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">rotate</span>:<span class="ActionScriptDefault_Text">Boolean</span>;            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_lookAtTarget</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_offset</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>                    <span class="ActionScriptDefault_Text">_target</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">moveRight</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_offset</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptBracket/Brace">)</span>;                    <span class="ActionScriptDefault_Text">_target</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">moveUp</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_offset</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span>;                    <span class="ActionScriptDefault_Text">_target</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">moveForward</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_offset</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">z</span><span class="ActionScriptBracket/Brace">)</span>;                <span class="ActionScriptBracket/Brace">}</span>                <span class="ActionScriptDefault_Text">_target</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">lookAt</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_lookAtTarget</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">position</span><span class="ActionScriptBracket/Brace">)</span>;                            <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_alignToPath</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_rotations</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">_rotations</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span><span class="ActionScriptOperator">&gt;</span>0 <span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">{</span>                                        <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_rotations</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">_index</span><span class="ActionScriptOperator">+</span>1<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">{</span>                                                 <span class="ActionScriptDefault_Text">_rot</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_rotations</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">_rotations</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span><span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">nT</span>;                         <span class="ActionScriptDefault_Text">_rot</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_rotations</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">_rotations</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span><span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">nT</span>;                         <span class="ActionScriptDefault_Text">_rot</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">z</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_rotations</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">_rotations</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span><span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">z</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">nT</span>;                                             <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptBracket/Brace">{</span>                                                 <span class="ActionScriptDefault_Text">_rot</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_rotations</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">_index</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">+</span>   <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_rotations</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">_index</span><span class="ActionScriptOperator">+</span>1<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">_rotations</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">_index</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">nT</span><span class="ActionScriptBracket/Brace">)</span>;                        <span class="ActionScriptDefault_Text">_rot</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_rotations</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">_index</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+</span>   <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_rotations</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">_index</span><span class="ActionScriptOperator">+</span>1<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">_rotations</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">_index</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">nT</span><span class="ActionScriptBracket/Brace">)</span>;                        <span class="ActionScriptDefault_Text">_rot</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">z</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_rotations</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">_index</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">z</span> <span class="ActionScriptOperator">+</span>   <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_rotations</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">_index</span><span class="ActionScriptOperator">+</span>1<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">z</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">_rotations</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">_index</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">z</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">nT</span><span class="ActionScriptBracket/Brace">)</span>;                                             <span class="ActionScriptBracket/Brace">}</span>                                         <span class="ActionScriptDefault_Text">_worldAxis</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">=</span> 0;                    <span class="ActionScriptDefault_Text">_worldAxis</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">=</span> 1;                    <span class="ActionScriptDefault_Text">_worldAxis</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">z</span> <span class="ActionScriptOperator">=</span> 0;                    <span class="ActionScriptDefault_Text">_worldAxis</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">PathUtils</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">rotatePoint</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_worldAxis</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">_rot</span><span class="ActionScriptBracket/Brace">)</span>;                                        <span class="ActionScriptDefault_Text">_target</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">lookAt</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_basePosition</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">_worldAxis</span><span class="ActionScriptBracket/Brace">)</span>;                                        <span class="ActionScriptDefault_Text">rotate</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;                                    <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptBracket/Brace">{</span>                     <span class="ActionScriptDefault_Text">_target</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">lookAt</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_position</span><span class="ActionScriptBracket/Brace">)</span>;                <span class="ActionScriptBracket/Brace">}</span>                             <span class="ActionScriptBracket/Brace">}</span>                                        <span class="ActionScriptDefault_Text">updateObjectPosition</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">rotate</span><span class="ActionScriptBracket/Brace">)</span>;                        <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_bSegment</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">_index</span> <span class="ActionScriptOperator">&gt;</span> 0 <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">_lastSegment</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">_index</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">t</span> <span class="ActionScriptOperator">&lt;</span> 1<span class="ActionScriptBracket/Brace">)</span>                <span class="ActionScriptDefault_Text">dispatchEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">PathEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">PathEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">CHANGE_SEGMENT</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;                         <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_bRange</span> <span class="ActionScriptOperator">&amp;&amp;</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">t</span> <span class="ActionScriptOperator">&gt;=</span> <span class="ActionScriptDefault_Text">_from</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">t</span> <span class="ActionScriptOperator">&lt;=</span> <span class="ActionScriptDefault_Text">_to</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>                <span class="ActionScriptDefault_Text">dispatchEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">PathEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">PathEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">RANGE</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;                                <span class="ActionScriptDefault_Text">_time</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">t</span>;            <span class="ActionScriptDefault_Text">_lastSegment</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_index</span>;        <span class="ActionScriptBracket/Brace">}</span>                <span class="ActionScriptASDoc">/**        * Updates a position Vector3D on the path at a given time. Do not use this handler to animate, it's in there to add dummy's or place camera before or after        * the animated object. Use the update() or the automatic tweened animateOnPath() handlers instead.        *        * @param t        Number. A Number  from 0 to 1        * @param out    Vector3D. The Vector3D to update according to the "t" time parameter.        */</span>        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getPositionOnPath</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">t</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">out</span>:<span class="ActionScriptDefault_Text">Vector3D</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Vector3D</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">_path</span><span class="ActionScriptBracket/Brace">)</span>  <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Error</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"No Path object set for this class"</span><span class="ActionScriptBracket/Brace">)</span>;                        <span class="ActionScriptDefault_Text">t</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">t</span><span class="ActionScriptOperator">&lt;</span>0<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">?</span> 0 : <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">t</span><span class="ActionScriptOperator">&gt;</span>1<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">?</span>1 : <span class="ActionScriptDefault_Text">t</span>;            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_path</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">t</span>;            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span>:<span class="ActionScriptDefault_Text">uint</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m</span>;            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ps</span>:<span class="ActionScriptDefault_Text">PathSegment</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_path</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">segments</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;                         <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">calcPosition</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">m</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">ps</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">out</span><span class="ActionScriptBracket/Brace">)</span>;        <span class="ActionScriptBracket/Brace">}</span>                <span class="ActionScriptASDoc">/**         * Returns a position on the path according to duration/elapsed time. Duration variable must be set.         *          * @param        ms            Number. A number representing milliseconds.         * @param        duration        Number. The total duration in milliseconds.         * @param        out            [optional] Vector3D. A Vector3D that will be used to return the position. If none provided, method returns a new Vector3D with this data.         *         * An example of use of this handler would be cases where a given "lap" must be done in a given amount of time and you would want to retrieve the "ideal" time         * based on elapsed time since start of the race. By comparing actual progress to ideal time, you could extract their classement, calculate distance/time between competitors,         * abort the race if goal is impossible to be reached in time etc...         *         *@ returns Vector3D The position at a given elapsed time, compared to total duration.         */</span>        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getPositionOnPathMS</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">ms</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">duration</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">out</span>:<span class="ActionScriptDefault_Text">Vector3D</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Vector3D</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">_path</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Error</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"No Path object set for this class"</span><span class="ActionScriptBracket/Brace">)</span>;                        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">t</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">abs</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ms</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">/</span><span class="ActionScriptDefault_Text">duration</span>;            <span class="ActionScriptDefault_Text">t</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">t</span><span class="ActionScriptOperator">&lt;</span>0<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">?</span> 0 : <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">t</span><span class="ActionScriptOperator">&gt;</span>1<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">?</span>1 : <span class="ActionScriptDefault_Text">t</span>;            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_path</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">t</span>;            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span>:<span class="ActionScriptDefault_Text">uint</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m</span>;            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ps</span>:<span class="ActionScriptDefault_Text">PathSegment</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_path</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">segments</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;                        <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">calcPosition</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">m</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">ps</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">out</span><span class="ActionScriptBracket/Brace">)</span>;        <span class="ActionScriptBracket/Brace">}</span>                <span class="ActionScriptASDoc">/**        * defines if the object animated along the path must be aligned to the path.        */</span>        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">set</span> <span class="ActionScriptDefault_Text">alignToPath</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">b</span>:<span class="ActionScriptDefault_Text">Boolean</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptDefault_Text">_alignToPath</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b</span>;        <span class="ActionScriptBracket/Brace">}</span>        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">alignToPath</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Boolean</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">_alignToPath</span>;        <span class="ActionScriptBracket/Brace">}</span>                <span class="ActionScriptASDoc">/**        * returns the current interpolated position on the path with no optional offset applied        */</span>        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">position</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Vector3D</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">_position</span>;        <span class="ActionScriptBracket/Brace">}</span>                <span class="ActionScriptASDoc">/**        * defines the path to follow        * @see Path        */</span>        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">set</span> <span class="ActionScriptDefault_Text">path</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">p</span>:<span class="ActionScriptDefault_Text">Path</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptDefault_Text">_path</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">p</span>;            <span class="ActionScriptDefault_Text">_worldAxis</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_path</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">worldAxis</span>;        <span class="ActionScriptBracket/Brace">}</span>        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">path</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Path</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">_path</span>;        <span class="ActionScriptBracket/Brace">}</span>        <span class="ActionScriptASDoc">/**        * Represents the progress of the animation playhead from the start (0) to the end (1) of the animation.        */</span>        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">progress</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Number</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">_time</span>;        <span class="ActionScriptBracket/Brace">}</span>        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">set</span> <span class="ActionScriptDefault_Text">progress</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">val</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_time</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">val</span><span class="ActionScriptBracket/Brace">)</span>                <span class="ActionScriptReserved">return</span>;                        <span class="ActionScriptDefault_Text">updateProgress</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">val</span><span class="ActionScriptBracket/Brace">)</span>;        <span class="ActionScriptBracket/Brace">}</span>                <span class="ActionScriptASDoc">/**        * returns the segment index that is used at a given time;        * @param     t        [Number]. A Number between 0 and 1. If no params, actual pathanimator time segment index is returned.        */</span>        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getTimeSegment</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">t</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">NaN</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Number</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptDefault_Text">t</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">t</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">_time</span> : <span class="ActionScriptDefault_Text">t</span>;            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">floor</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">path</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">t</span><span class="ActionScriptBracket/Brace">)</span>;        <span class="ActionScriptBracket/Brace">}</span>                 <span class="ActionScriptASDoc">/**        * returns the actual interpolated rotation along the path.        */</span>        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">orientation</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Vector3D</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">_rot</span>;        <span class="ActionScriptBracket/Brace">}</span>                 <span class="ActionScriptASDoc">/**        * sets the object to be animated along the path.        */</span>        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">set</span> <span class="ActionScriptDefault_Text">target</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">object3d</span>:<span class="ActionScriptDefault_Text">Object3D</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptDefault_Text">_target</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">target</span>;        <span class="ActionScriptBracket/Brace">}</span>        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">target</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Object3D</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">_target</span>;        <span class="ActionScriptBracket/Brace">}</span>                <span class="ActionScriptASDoc">/**        * sets the object that the animated object will be looking at along the path        */</span>        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">set</span> <span class="ActionScriptDefault_Text">lookAtObject</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">object3d</span>:<span class="ActionScriptDefault_Text">Object3D</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptDefault_Text">_lookAtTarget</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">object3d</span>;            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_alignToPath</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">_alignToPath</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;        <span class="ActionScriptBracket/Brace">}</span>        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">lookAtObject</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Object3D</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">_lookAtTarget</span>;        <span class="ActionScriptBracket/Brace">}</span>                <span class="ActionScriptASDoc">/**        * sets an optional Vector.&lt;Vector3D&gt; of rotations. if the object3d is animated along a PathExtrude object, use the very same vector to follow the "curves".        */</span>        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">set</span> <span class="ActionScriptDefault_Text">rotations</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">vRot</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">Vector3D</span><span class="ActionScriptBracket/Brace">&gt;</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptDefault_Text">_rotations</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">vRot</span>;                        <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_rotations</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">_rot</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>                <span class="ActionScriptDefault_Text">_rot</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Vector3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;                <span class="ActionScriptDefault_Text">_tmpOffset</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Vector3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;            <span class="ActionScriptBracket/Brace">}</span>        <span class="ActionScriptBracket/Brace">}</span>                 <span class="ActionScriptASDoc">/**        * Set the pointer to a given segment along the path        */</span>        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">set</span> <span class="ActionScriptDefault_Text">index</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">val</span>:<span class="ActionScriptDefault_Text">uint</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptDefault_Text">_index</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">val</span> <span class="ActionScriptOperator">&gt;</span> <span class="ActionScriptDefault_Text">_path</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">-</span> 1<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">_path</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">-</span> 1 : <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">val</span> <span class="ActionScriptOperator">&gt;</span> 0<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">val</span> : 0;        <span class="ActionScriptBracket/Brace">}</span>        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">index</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">uint</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">_index</span>;        <span class="ActionScriptBracket/Brace">}</span>                <span class="ActionScriptASDoc">/**         * Default method for adding a cycle event listener. Event fired when the time reaches 1.         *          * @param    listener        The listener function         */</span>        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">addOnCycle</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">listener</span>:<span class="ActionScriptDefault_Text">Function</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptDefault_Text">_lastTime</span> <span class="ActionScriptOperator">=</span> 0;            <span class="ActionScriptDefault_Text">_bCycle</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;            <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">PathEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">CYCLE</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">listener</span><span class="ActionScriptBracket/Brace">)</span>;        <span class="ActionScriptBracket/Brace">}</span>                <span class="ActionScriptASDoc">/**         * Default method for removing a cycle event listener         *          * @param        listener        The listener function         */</span>        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">removeOnCycle</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">listener</span>:<span class="ActionScriptDefault_Text">Function</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptDefault_Text">_bCycle</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;            <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">removeEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">PathEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">CYCLE</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">listener</span><span class="ActionScriptBracket/Brace">)</span>;        <span class="ActionScriptBracket/Brace">}</span>                <span class="ActionScriptASDoc">/**        * Default method for adding a range event listener. Event fired when the time is &gt;= from and &lt;= to variables.        *         * @param        listener        The listener function        */</span>        <span class="ActionScriptComment">//note: If there are requests for this, it could be extended to more than one rangeEvent per path. </span>        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">addOnRange</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">listener</span>:<span class="ActionScriptDefault_Text">Function</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">from</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">to</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 0<span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptDefault_Text">_from</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">from</span>;            <span class="ActionScriptDefault_Text">_to</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">to</span>;            <span class="ActionScriptDefault_Text">_bRange</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;            <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">PathEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">RANGE</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">listener</span><span class="ActionScriptBracket/Brace">)</span>;        <span class="ActionScriptBracket/Brace">}</span>                <span class="ActionScriptASDoc">/**         * Default method for removing a range event listener         *          * @param        listener        The listener function         */</span>        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">removeOnRange</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">listener</span>:<span class="ActionScriptDefault_Text">Function</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptDefault_Text">_from</span> <span class="ActionScriptOperator">=</span> 0;            <span class="ActionScriptDefault_Text">_to</span> <span class="ActionScriptOperator">=</span> 0;            <span class="ActionScriptDefault_Text">_bRange</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;            <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">removeEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">PathEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">RANGE</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">listener</span><span class="ActionScriptBracket/Brace">)</span>;        <span class="ActionScriptBracket/Brace">}</span>                <span class="ActionScriptASDoc">/**         * Default method for adding a segmentchange event listener. Event fired when the time pointer enters another PathSegment.         *          * @param        listener        The listener function         */</span>        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">addOnChangeSegment</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">listener</span>:<span class="ActionScriptDefault_Text">Function</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptDefault_Text">_bSegment</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;            <span class="ActionScriptDefault_Text">_lastSegment</span> <span class="ActionScriptOperator">=</span> 0;            <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">PathEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">CHANGE_SEGMENT</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">listener</span><span class="ActionScriptBracket/Brace">)</span>;        <span class="ActionScriptBracket/Brace">}</span>                <span class="ActionScriptASDoc">/**        * Default method for removing a range event listener        *         * @param        listener        The listener function        */</span>        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">removeOnChangeSegment</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">listener</span>:<span class="ActionScriptDefault_Text">Function</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptDefault_Text">_bSegment</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;            <span class="ActionScriptDefault_Text">_lastSegment</span> <span class="ActionScriptOperator">=</span> 0;            <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">removeEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">PathEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">CHANGE_SEGMENT</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">listener</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span>;        <span class="ActionScriptBracket/Brace">}</span>                <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">calcPosition</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">t</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">ps</span>:<span class="ActionScriptDefault_Text">PathSegment</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">out</span>:<span class="ActionScriptDefault_Text">Vector3D</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Vector3D</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">dt</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 2 <span class="ActionScriptOperator">*</span> <span class="ActionScriptBracket/Brace">(</span>1 <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">t</span><span class="ActionScriptBracket/Brace">)</span>;            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">v</span>:<span class="ActionScriptDefault_Text">Vector3D</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">out</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Vector3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;            <span class="ActionScriptDefault_Text">v</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ps</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">pStart</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">t</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dt</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ps</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">pControl</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">ps</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">pStart</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">t</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ps</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">pEnd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">ps</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">pStart</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;            <span class="ActionScriptDefault_Text">v</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ps</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">pStart</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">t</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dt</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ps</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">pControl</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">ps</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">pStart</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">t</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ps</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">pEnd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">ps</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">pStart</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;            <span class="ActionScriptDefault_Text">v</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">z</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ps</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">pStart</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">z</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">t</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dt</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ps</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">pControl</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">z</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">ps</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">pStart</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">z</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">t</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ps</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">pEnd</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">z</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">ps</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">pStart</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">z</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;                        <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">v</span>;        <span class="ActionScriptBracket/Brace">}</span>                 <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">updatePosition</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">t</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">ps</span>:<span class="ActionScriptDefault_Text">PathSegment</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>        <span class="ActionScriptBracket/Brace">{</span>            <span class="ActionScriptDefault_Text">_basePosition</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">calcPosition</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">t</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">ps</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">_basePosition</span><span class="ActionScriptBracket/Brace">)</span>;                         <span class="ActionScriptDefault_Text">_position</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_basePosition</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span>;            <span class="ActionScriptDefault_Text">_position</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_basePosition</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span>;            <span class="ActionScriptDefault_Text">_position</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">z</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_basePosition</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">z</span>;        <span class="ActionScriptBracket/Brace">}</span>                <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">updateObjectPosition</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">rotate</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span><span class="ActionScriptBracket/Brace">{</span>                        <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">rotate</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">_offset</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">{</span>                                 <span class="ActionScriptDefault_Text">_tmpOffset</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_offset</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span>;                 <span class="ActionScriptDefault_Text">_tmpOffset</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_offset</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span>;                 <span class="ActionScriptDefault_Text">_tmpOffset</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">z</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_offset</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">z</span>;                 <span class="ActionScriptDefault_Text">_tmpOffset</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">PathUtils</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">rotatePoint</span><span class="ActionScriptBracket/Brace">(</span>  <span class="ActionScriptDefault_Text">_tmpOffset</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">_rot</span><span class="ActionScriptBracket/Brace">)</span>;                                  <span class="ActionScriptDefault_Text">_position</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">_tmpOffset</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span>;                 <span class="ActionScriptDefault_Text">_position</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">_tmpOffset</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span>;                 <span class="ActionScriptDefault_Text">_position</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">z</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">_tmpOffset</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">z</span>;                             <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_offset</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>                                <span class="ActionScriptDefault_Text">_position</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">_offset</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span>;                <span class="ActionScriptDefault_Text">_position</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">_offset</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span>;                <span class="ActionScriptDefault_Text">_position</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">z</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">_offset</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">z</span>;                            <span class="ActionScriptBracket/Brace">}</span>             <span class="ActionScriptDefault_Text">_target</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">position</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_position</span>;        <span class="ActionScriptBracket/Brace">}</span>            <span class="ActionScriptBracket/Brace">}</span><span class="ActionScriptBracket/Brace">}</span></pre></body>
</html>
